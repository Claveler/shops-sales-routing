.page {
  display: flex;
  flex-direction: column;
  height: 100vh;
  width: 100vw;
  overflow: hidden;
  background: #F8F9F9;
}

.body {
  display: flex;
  flex: 1;
  min-height: 0;
  overflow: hidden;
}

/* ---- Main content area (left side) ---- */
.main {
  flex: 1 1 auto;
  display: flex;
  flex-direction: column;
  min-width: 0;
  max-width: calc(100% - 400px);
  overflow: hidden;
}

@media (min-width: 1397px) {
  .main {
    max-width: calc(100% - 28.633vw);
  }
}

.topBar {
  display: flex;
  align-items: flex-end;
  justify-content: space-between;
  padding: 16px 16px 0 16px;
  flex-shrink: 0;
  position: relative;
  z-index: 2;
}


.topBar > :first-child {
  flex: 1;
  min-width: 0;
}

.actions {
  display: flex;
  align-items: center;
  gap: 8px;
  /* Keep action circles visibly above the folder border seam. */
  padding-bottom: 6px;
  flex-shrink: 0;
}

.actionBtn {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 44px;
  height: 44px;
  border-radius: 50%;
  font-size: 18px;
  color: var(--fz-primary-600, #0079CA);
  background: var(--fz-bg-card, #fff);
  border: 2px solid #BCC5CD;
  cursor: pointer;
  transition: background var(--fz-transition-fast, 150ms ease-in-out);
}

/* Hover disabled in touch mode (iMin simulation) */
:global([data-touch-mode="true"]) .actionBtn:hover {
  background: var(--fz-bg-card, #fff);
}

.actionBtn:hover {
  background: var(--fz-bg-subtle, #f9fafb);
}

/* ---- Member pill (identified member state) ---- */
.memberPill {
  display: flex;
  align-items: center;
  gap: 8px;
  height: 44px;
  padding: 0 16px;
  border-radius: 64px;
  border: 2px solid #CCD2D8;
  background: #FFFFFF;
  cursor: pointer;
  overflow: hidden;
  white-space: nowrap;
  transition: background var(--fz-transition-fast, 150ms ease-in-out);
}

/* Hover disabled in touch mode (iMin simulation) */
:global([data-touch-mode="true"]) .memberPill:hover {
  background: #FFFFFF;
}

.memberPill:hover {
  background: var(--fz-bg-subtle, #f9fafb);
}

.memberPillIcon {
  font-size: 14px;
  color: var(--fz-primary-600, #0079CA);
  flex-shrink: 0;
}

.memberPillName {
  font-size: 14px;
  line-height: 20px;
  font-weight: 400;
  color: #031419;
  min-width: 0;
  overflow: hidden;
  text-overflow: ellipsis;
}

.memberPillTier {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  min-width: 46px;
  height: 20px;
  padding: 0 6px;
  border-radius: 4px;
  border: 1px solid currentColor;
  background: transparent;
  font-size: 11px;
  line-height: 16px;
  font-weight: 400;
  white-space: nowrap;
  flex-shrink: 0;
}

.memberPillTierIcon {
  font-size: 9px;
  margin-right: 4px;
  opacity: 0.85;
}

.memberPillClose {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 20px;
  height: 20px;
  font-size: 10px;
  color: #031419;
  background: none;
  border: none;
  padding: 0;
  cursor: pointer;
  flex-shrink: 0;
  border-radius: 50%;
}

/* Hover disabled in touch mode (iMin simulation) */
:global([data-touch-mode="true"]) .memberPillClose:hover {
  background: none;
}

.memberPillClose:hover {
  background: rgba(0, 0, 0, 0.08);
}

/* ---- Content: filters + grid ---- */
.content {
  flex: 1;
  display: flex;
  flex-direction: column;
  padding: 8px 16px 16px;
  min-height: 0;
  overflow: hidden;
  background: #FFFFFF;
  border: 1px solid var(--fz-border-color, #ccd2d8);
  border-radius: 12px 12px 12px 12px;
  margin: 0 16px 16px;
  position: relative;
  z-index: 1;
}

/* When the first tab (leftmost) is active, flatten the top-left corner
   so the content panel connects flush with the tab marker above it. */
.contentFirstTab {
  border-radius: 0 12px 12px 12px;
}

.contentInner {
  flex: 1;
  display: flex;
  flex-direction: column;
  gap: 12px;
  min-height: 0;
  overflow: hidden;
  padding: 8px 16px 16px;
  background: #FFFFFF;
  border-radius: var(--fz-border-radius, 8px);
}

/* ---- iMin Device Preview ---- */
.devicePreviewBackdrop {
  position: absolute;
  inset: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  background: #F7F8FB;
  z-index: 1;
  overflow: hidden;
}

/* Floating toggle button — sits outside the device frame in the backdrop */
/* Root wrapper for device-preview mode: fills the viewport, stacks
   the external toggle above the scrollable backdrop. */
.devicePreviewRoot {
  position: relative;
  width: 100vw;
  height: 100vh;
  overflow: hidden;
}

/* Greyed logo for simulation view - positioned using exact measured values from header.
   Measured: left: 72px, top: 20px */
.devicePreviewLogo {
  position: absolute;
  top: 20px;
  left: 72px;
  height: 32px;
  display: block;
  filter: brightness(0.4);
  z-index: 2;
}

/* Toggle button - positioned using exact measured values from header.
   Measured: left: 228px, top: 16px */
.devicePreviewToggleFloat {
  position: absolute;
  top: 16px;
  left: 228px;
  z-index: 2;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 6px;
  height: 40px;
  padding: 0 10px;
  border-radius: 8px;
  border: 1px solid rgba(255, 255, 255, 0.25);
  background: var(--fz-primary-600, #0079CA);
  color: #fff;
  font-size: 14px;
  font-weight: 500;
  cursor: pointer;
  transition: background-color 200ms ease, border-color 200ms ease;
}

.devicePreviewToggleFloat:hover {
  background: #006bb5;
  border-color: #006bb5;
}

.devicePreviewToggleText {
  display: flex;
  flex-direction: column;
  align-items: flex-start;
  line-height: 1.15;
  font-size: 12px;
}

/*
 * 3/4-angle iMin Swan 1 Pro device frame.
 * Image: 7680×4320.  The frame container matches at 1:1 so the
 * matrix3d corner coordinates (in px) line up directly.
 */
.deviceFrame {
  position: relative;
  width: 7680px;
  height: 4320px;
  flex-shrink: 0;
  transform-origin: center;
}

.deviceImage {
  display: block;
  width: 100%;
  height: 100%;
  object-fit: contain;
  pointer-events: none;
  user-select: none;
}

/*
 * The POS content (1397×786) is perspective-warped via matrix3d to land
 * on the screen quadrilateral measured from the product photo (Photopea):
 *   TL (2252, 821.34)     TR (5070.92, 915.66)
 *   BL (2639.73, 2778.30) BR (5497.92, 2629.11)
 *
 * TL X visually calibrated to 2254, Y to 822.34 (Photopea raw was 2553.53 but that
 * left the screen wallpaper exposed at the top-left corner).
 *
 * matrix3d computed via DLT (Direct Linear Transform) from 4-point
 * correspondences mapping the rectangle (0,0)–(1397,786) to those corners.
 */
.deviceScreen {
  position: absolute;
  top: 0;
  left: 0;
  width: 1397px;
  height: 786px;
  overflow: hidden;
  transform-origin: 0 0;
  transform: matrix3d(
    2.5227920715,  0.1586960179, 0, 0.0000995784,
    0.3773553358,  2.3677450168, 0, -0.0000439211,
    0,              0,            1,  0,
    2252,           821.34,       0,  1
  );
  /* Subtle overall softening to reduce the "too crisp for a photo" look */
  filter: blur(0.2px);
  /* Hide default cursor within the device screen for touchscreen simulation */
  cursor: none;
}

/* Ensure cursor is hidden on all interactive elements within the device screen */
.deviceScreen * {
  cursor: none !important;
}

/* Touchscreen-style cursor for simulation mode (SVG-based) */
.touchCursor {
  position: fixed;
  pointer-events: none;
  z-index: 99999;
  /* Center the SVG on the cursor position */
  transform: translate(-50%, -50%);
  opacity: 0;
  /* Only transition opacity, not position (left/top) for instant tracking */
  transition: opacity 0.15s ease;
  /* Use will-change for GPU acceleration */
  will-change: left, top, opacity;
  overflow: visible;
}

.touchCursor.visible {
  opacity: 1;
}

.touchCursor.pressed ellipse {
  fill: rgba(0, 121, 202, 0.25);
  stroke: rgba(0, 121, 202, 0.5);
}

/* Device preview backdrop - normal cursor here */
.devicePreviewBackdrop {
  position: absolute;
  inset: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  background: #F7F8FB;
  z-index: 1;
  overflow: hidden;
}

/*
 * Depth-of-field overlay: simulates camera focus fall-off.
 * Left edge (closer to camera) stays sharp; right edge (further) gets blurred.
 * Uses backdrop-filter with a gradient mask so no DOM duplication is needed.
 */
.deviceScreenDofOverlay {
  position: absolute;
  inset: 0;
  pointer-events: none;
  backdrop-filter: blur(0.6px);
  -webkit-backdrop-filter: blur(0.6px);
  mask-image: linear-gradient(to right, transparent 0%, transparent 15%, black 85%, black 100%);
  -webkit-mask-image: linear-gradient(to right, transparent 0%, transparent 15%, black 85%, black 100%);
  z-index: 1;
}

/*
 * Screen glare overlay: replicates the diagonal glare visible in the
 * product photo.  The glare crosses the display from ~(66.6%, 0%) at
 * the top to ~(14.1%, 100%) at the bottom — angle ≈ 133°.
 * Mathematically the glare line sits at ~43.56% along the 133° gradient.
 *
 * The gradient fades in very gradually from the left edge, reaching peak
 * brightness at the glare line, then cuts off sharply on the right.
 */
.deviceScreenGlare {
  position: absolute;
  inset: 0;
  pointer-events: none;
  z-index: 10000; /* Must be higher than any modal backdrop to stay visible */
  background:
    /* Gradual fade from left, razor-sharp cutoff on the right */
    linear-gradient(
      133deg,
      transparent 0%,
      rgba(255, 255, 255, 0.03) 10%,
      rgba(255, 255, 255, 0.08) 20%,
      rgba(255, 255, 255, 0.15) 30%,
      rgba(255, 255, 255, 0.25) 38%,
      rgba(255, 255, 255, 0.30) 43.6%,
      transparent 43.64%,
      transparent 100%
    );
}

/* Loading placeholder shown while the device frame image is still loading */
.devicePreviewLoading {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 12px;
  color: #999;
  font-size: 14px;
}

/* Fade-in when the device frame image finishes loading */
.deviceFrameReady {
  animation: deviceFadeIn 0.4s ease-out both;
}

@keyframes deviceFadeIn {
  from { opacity: 0; }
  to   { opacity: 1; }
}

/*
 * Device-preview simulation: the page is hard-locked to the iMin Swan 1 Pro
 * effective resolution (1397×786 dp).  Because the viewport-dependent cart
 * breakpoint (28.633vw at ≥1397px) fires against the *real* browser viewport
 * — not this constrained container — we must force the cart and main area
 * back to their fixed-width values so the simulation is pixel-accurate.
 */
.pageConstrained {
  width: 1397px;
  height: 786px;
}

.pageConstrained .body .main {
  max-width: calc(100% - 400px);
}

.pageConstrained .body aside {
  min-width: 400px;
  max-width: 400px;
}
